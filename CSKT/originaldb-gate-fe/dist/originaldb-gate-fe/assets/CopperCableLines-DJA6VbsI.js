import{O as z,Q as P,R,t as V,v as B,w as j,x as G,r as m,j as o,k as H,q as Q,F as W,y as a,U as X,H as $,cz as J,aO as Y,B as F,W as Z,E as v,G as ee}from"./index-DXrCg2vr.js";import{b as ne,m as te}from"./OpticalFiberLines.action-Da9FPpJg.js";import{a as se}from"./FiberLineType.action--k-1Z-uG.js";import{M as oe}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{I as A}from"./ItemsComponent-Ct2UsBCT.js";import{a as ie}from"./arrayToTree.min-Bpdh5Rxo.js";import"./index-B0_H1u92.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";const w="optical_fiber_lines",re=i=>z(w,{...i}),ae=(i,n)=>P(w,i,{...n}),ce=i=>R(w,i),de=({action:i,detail:n})=>{const[b]=V.useForm(),c=B(),x=j(),{openMessage:l}=G();m.useState(null);const[d,g]=m.useState({organizations:[],fiberLineType:[]}),p=m.useMemo(()=>[{title:"Tên",content:(n==null?void 0:n.name)||null,dataIndex:"name",rules:[{required:!0,message:"Thông tin không được để trống!"}]},{title:"Loại tuyến cáp",content:(n==null?void 0:n.type_id)||null,dataIndex:"type_id",rules:[{required:!0,message:"Loại tuyến cáp không được để trống!"}]},{title:"Ký hiệu",content:(n==null?void 0:n.symbol)||null,dataIndex:"symbol"},{title:"Đơn vị quản lý",content:(n==null?void 0:n.org_manage_id)||null,dataIndex:"org_manage_id"},{title:"Đơn vị khai thác",content:(n==null?void 0:n.org_use_id)||null,dataIndex:"org_use_id"},{title:"Đơn vị bảo đảm kỹ thuật",content:(n==null?void 0:n.org_suport_id)||null,dataIndex:"org_suport_id"},{title:"Độ dài tuyến cáp",content:(n==null?void 0:n.length)||null,dataIndex:"length"},{title:"Độ dài quản lý",content:(n==null?void 0:n.manage_length)||null,dataIndex:"manage_length"},{title:"Tọa độ",content:(n==null?void 0:n.coordinates)||null,dataIndex:"coordinates"},{title:"Điểm đầu",content:(n==null?void 0:n.first_point)||null,dataIndex:"first_point"},{title:"Điểm cuối",content:(n==null?void 0:n.final_point)||null,dataIndex:"final_point"},{title:"Tổng số sợi",content:(n==null?void 0:n.number_of_fiber)||null,dataIndex:"number_of_fiber"},{title:"Mô tả",content:(n==null?void 0:n.desc)||null,dataIndex:"desc"},{title:"Số thứ tự",content:(n==null?void 0:n.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(n==null?void 0:n.is_enable)===void 0?!0:n==null?void 0:n.is_enable,dataIndex:"is_enable"}],[n]),C=async()=>{const e=await Promise.all([await X({}),await se({},{})]);g({organizations:ie.arrayToTree([...e[0]],{dataField:null}),fiberLineType:e[1]})},u=()=>{if(i===a.View){f();return}else b.submit()},f=()=>{c.hide(),x.closeModal({success:!0})},h=async()=>{var e,r,k,y,I,L,T,S,D,E;try{c.show();const t=b.getFieldsValue();switch(i){case a.Update:const K=(e=t==null?void 0:t.org_manage_id)!=null&&e.value?(r=t==null?void 0:t.org_manage_id)==null?void 0:r.value:t==null?void 0:t.org_manage_id,q=(k=t==null?void 0:t.org_use_id)!=null&&k.value?(y=t==null?void 0:t.org_use_id)==null?void 0:y.value:t==null?void 0:t.org_use_id,M=(I=t==null?void 0:t.org_technical_id)!=null&&I.value?(L=t==null?void 0:t.org_technical_id)==null?void 0:L.value:t==null?void 0:t.org_technical_id,O=(T=t==null?void 0:t.org_support_id)!=null&&T.value?(S=t==null?void 0:t.org_support_id)==null?void 0:S.value:t==null?void 0:t.org_support_id,U=(D=t==null?void 0:t.type_id)!=null&&D.value?(E=t==null?void 0:t.type_id)==null?void 0:E.value:t==null?void 0:t.type_id;await ae(n==null?void 0:n.id,{...t,org_manage_id:K,org_use_id:q,org_technical_id:M,org_support_id:O,type_id:U}),l({type:"success",content:"Cập nhật thành công"});break;case a.Create:await re({...t}),l({type:"success",content:"Thêm mới thành công"}),b.resetFields();break;case a.View:break}f()}catch(t){console.log(t),l({type:"error",content:(t==null?void 0:t.message)||"Lỗi hệ thống"}),c.hide()}},_=async()=>{try{await ce(n==null?void 0:n.id),l({type:"success",content:"Xóa thành công"}),f()}catch(e){console.log(e),l({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"})}},s=e=>{if(["type_id"].includes(e))return $(d==null?void 0:d.fiberLineType,"name","id")};return m.useEffect(()=>{C()},[]),o.jsxDEV(H,{...Q,className:"flex",size:20,children:[o.jsxDEV(W,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:o.jsxDEV(oe,{name:"danh sách tuyến cáp",action:i,hanldeFinish:u,handleDelete:_},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/CopperCableLinesAction.tsx",lineNumber:247,columnNumber:9},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/CopperCableLinesAction.tsx",lineNumber:242,columnNumber:7},void 0),o.jsxDEV(V,{form:b,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",onFinish:h,disabled:i===a.View,children:i===a.Update||i===a.Create?o.jsxDEV(o.Fragment,{children:p.map((e,r)=>o.jsxDEV(A,{title:e==null?void 0:e.title,rules:e==null?void 0:e.rules,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!0,dataIndex:e.dataIndex,isNumberField:e.dataIndex==="order_number"||e.dataIndex==="length"||e.dataIndex==="manage_length"||e.dataIndex==="number_of_fiber",selectField:{isSelect:e.dataIndex==="type_id",dataSelect:e.dataIndex==="type_id"?s(e.dataIndex):d.copperCableLines},treeField:{isSelect:(e==null?void 0:e.dataIndex)==="org_manage_id"||(e==null?void 0:e.dataIndex)==="org_use_id"||(e==null?void 0:e.dataIndex)==="org_technical_id"||(e==null?void 0:e.dataIndex)==="org_suport_id",dataSelect:d.organizations},isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},r,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/CopperCableLinesAction.tsx",lineNumber:264,columnNumber:17},void 0))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/CopperCableLinesAction.tsx",lineNumber:261,columnNumber:11},void 0):o.jsxDEV(o.Fragment,{children:p.map((e,r)=>o.jsxDEV("div",{className:"flex flex-col pb-4",children:o.jsxDEV(A,{title:e==null?void 0:e.title,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!1,dataIndex:e==null?void 0:e.dataIndex,isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},r,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/CopperCableLinesAction.tsx",lineNumber:303,columnNumber:19},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/CopperCableLinesAction.tsx",lineNumber:302,columnNumber:17},void 0))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/CopperCableLinesAction.tsx",lineNumber:299,columnNumber:11},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/CopperCableLinesAction.tsx",lineNumber:254,columnNumber:7},void 0)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/CopperCableLinesAction.tsx",lineNumber:241,columnNumber:5},void 0)},N=de,pe=[{key:a.View,icon:o.jsxDEV(ee,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/CopperCableLines.tsx",lineNumber:31,columnNumber:11},void 0),tooltip:"Chi tiết"}];function Ce(){const{openModal:i}=j(),[n,b]=m.useState([]),[c,x]=m.useState({count:0}),[l,d]=m.useState(!1),g=m.useRef({...J}),p=Y();console.log("pathname: ",p.pathname.split("/")[p.pathname.split("/").length-1]);const C=[{title:"Tên tuyến cáp",dataIndex:"name",width:200,fixed:"left",key:F.Name,render:(s,e)=>o.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>h(a.View,e),children:s??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/CopperCableLines.tsx",lineNumber:60,columnNumber:11},this)},{title:"Phân loại tuyến cáp",dataIndex:"type_id",width:150,render:s=>(s==null?void 0:s.name)??""},{title:"Đơn vị quản lý tuyến cáp",dataIndex:"org_manage_id",width:300,render:s=>(s==null?void 0:s.name)??""},{title:"Độ dài tuyến cáp",dataIndex:"length",width:150},{title:"Độ dài quản lý",dataIndex:"manage_length",width:150},{title:"Vị trí điểm đầu",dataIndex:"first_point",width:150},{title:"Vị trí điểm cuối",dataIndex:"final_point",width:150},{title:"Tổng số sợi",dataIndex:"number_of_fiber",width:150},{title:"Ghi chú",dataIndex:"note",width:150},{title:"Trạng thái",dataIndex:"is_enable",width:150,render:s=>s?o.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/CopperCableLines.tsx",lineNumber:118,columnNumber:11},this):o.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/CopperCableLines.tsx",lineNumber:120,columnNumber:11},this)}].map(s=>({...s,key:(s==null?void 0:s.key)||Z()})),u=async(s,e)=>{try{d(!0);const r=await Promise.all([await ne({limit:e,page:s},{type_id:{name:{_icontains:p.pathname.split("/")[p.pathname.split("/").length-1].includes("quang")?"quang":"đồng"}}}),await te({type_id:{name:{_icontains:p.pathname.split("/")[p.pathname.split("/").length-1].includes("quang")?"quang":"đồng"}}})]);b(r[0]),x(r[1]),d(!1)}catch{d(!1)}},f=s=>{i(o.jsxDEV(N,{detail:s,action:a.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/CopperCableLines.tsx",lineNumber:169,columnNumber:15},this),{width:"40vw",onModalClose(e){e!=null&&e.success&&i(o.jsxDEV(N,{detail:s,action:a.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/CopperCableLines.tsx",lineNumber:174,columnNumber:13},this),{width:"40vw",onModalClose(r){r!=null&&r.success&&_()}})}})},h=(s,e)=>{console.log(s),s===a.View&&f(e)},_=()=>{u(g.current.current,g.current.pageSize)};return m.useEffect(()=>{u(g.current.current,g.current.pageSize)},[]),o.jsxDEV("div",{className:"w-[900px]",children:o.jsxDEV(v,{total:(c==null?void 0:c.count)||0,className:"mt-5",isReloadButton:!1,dataSource:n,columns:C,actionList:pe,isAction:!1,loading:l,paginationCustom:{...g.current,total:c==null?void 0:c.count},onChange:({current:s,pageSize:e})=>{g.current={current:s,pageSize:e},u(s,e)},actionClick:h,filterColumns:[F.Name],btnCreate:!0,handleCreate:()=>{i(o.jsxDEV(N,{action:a.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/CopperCableLines.tsx",lineNumber:227,columnNumber:21},this),{width:"40vw",onModalClose(s){s!=null&&s.success&&_()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/CopperCableLines.tsx",lineNumber:205,columnNumber:7},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/CopperCableLines.tsx",lineNumber:204,columnNumber:5},this)}export{pe as ACTION_TABLE,Ce as default};
