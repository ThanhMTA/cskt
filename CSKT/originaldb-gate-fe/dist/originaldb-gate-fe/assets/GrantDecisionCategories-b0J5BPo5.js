import{e as G,J as y,O as _,Q as j,R as K,t as w,v as A,w as E,x as I,r as m,j as t,k as F,q as M,F as q,y as o,z as L,B as S,E as P,G as z}from"./index-DXrCg2vr.js";import{M as U}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{I as T}from"./ItemsComponent-Ct2UsBCT.js";import"./index-B0_H1u92.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";const R=(s,i)=>G("grant_decision_categories",{...s,fields:["*"],filter:i,sort:["order_number"]}),B=async s=>{var c;return{count:(c=(await y("grant_decision_categories",{aggregate:{countDistinct:"id"},query:{filter:s}}))[0].countDistinct)==null?void 0:c.id}},O=s=>_("grant_decision_categories",{...s}),H=(s,i)=>j("grant_decision_categories",s,{...i}),J=s=>K("grant_decision_categories",s);function D({detail:s,action:i}){const[c]=w.useForm(),d=A(),f=E(),{openMessage:r}=I(),h=async()=>{try{d.show();const e=c.getFieldsValue();switch(i){case o.Update:await H(s==null?void 0:s.id,e),r({type:"success",content:"Cập nhật thành công"});break;case o.Create:await O(e),r({type:"success",content:"Thêm mới thành công"}),c.resetFields();break;case o.View:break}l()}catch(e){console.log(e),r({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"}),d.hide()}},N=async()=>{try{await J(s==null?void 0:s.id),r({type:"success",content:"Xóa thành công"}),d.hide(),f.closeModal({})}catch(e){console.log(e),r({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"})}},u=()=>{if(i===o.View){l();return}else c.submit()},l=()=>{d.hide(),f.closeModal({success:!0})},b=m.useMemo(()=>[{title:"Tên cấp quyết định",content:(s==null?void 0:s.name)||null,require:!0,dataIndex:"name",fixed:"left",rules:[{required:!0,message:"Thông tin không được để trống."}]},{title:"Số thứ tự",content:(s==null?void 0:s.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(s==null?void 0:s.is_enable)===void 0?!0:s==null?void 0:s.is_enable,dataIndex:"is_enable"}],[s]);return t.jsxDEV(F,{...M,className:"flex",size:20,children:[t.jsxDEV(q,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:t.jsxDEV(U,{name:"cấp quyết định",action:i,hanldeFinish:u,handleDelete:N},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/components/GrantDecisionAction.tsx",lineNumber:125,columnNumber:17},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/components/GrantDecisionAction.tsx",lineNumber:120,columnNumber:13},this),t.jsxDEV(w,{form:c,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",initialValues:s,disabled:i===o.View,onFinish:h,children:i===o.Update||i===o.Create?t.jsxDEV(t.Fragment,{children:b.map((e,g)=>t.jsxDEV(T,{title:e==null?void 0:e.title,rules:e==null?void 0:e.rules,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!0,isNumberField:(e==null?void 0:e.dataIndex)==="order_number",isRadioField:(e==null?void 0:e.dataIndex)==="is_enable",dataIndex:e.dataIndex},g,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/components/GrantDecisionAction.tsx",lineNumber:138,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/components/GrantDecisionAction.tsx",lineNumber:135,columnNumber:21},this):t.jsxDEV(t.Fragment,{children:b.map((e,g)=>t.jsxDEV("div",{className:"flex flex-col pb-4",children:t.jsxDEV(T,{title:e==null?void 0:e.title,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!1,dataIndex:e.dataIndex,isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},g,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/components/GrantDecisionAction.tsx",lineNumber:157,columnNumber:37},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/components/GrantDecisionAction.tsx",lineNumber:156,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/components/GrantDecisionAction.tsx",lineNumber:153,columnNumber:21},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/components/GrantDecisionAction.tsx",lineNumber:127,columnNumber:13},this)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/components/GrantDecisionAction.tsx",lineNumber:115,columnNumber:9},this)}const Q=[{key:o.View,icon:t.jsxDEV(z,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/pages/GrantDecisionCategories.tsx",lineNumber:19,columnNumber:15},void 0),tooltip:"Chi tiết"}];function ee(){const{openModal:s}=E(),[i,c]=m.useState({page:1,pageSize:L}),[d,f]=m.useState([]),[r,h]=m.useState({count:0}),[N,u]=m.useState(!1),[l,b]=m.useState({}),e=[{title:"Tên",dataIndex:"name",fixed:"left",key:S.Name,render:(n,a)=>t.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>C(o.View,a),children:n??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/pages/GrantDecisionCategories.tsx",lineNumber:40,columnNumber:21},this)},{title:"Trạng thái",dataIndex:"is_enable",key:"is_enable",render:n=>n?t.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/pages/GrantDecisionCategories.tsx",lineNumber:54,columnNumber:31},this):t.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/pages/GrantDecisionCategories.tsx",lineNumber:54,columnNumber:83},this)}],g=async(n,a,k)=>{try{u(!0);const p=await Promise.all([R({limit:a,page:n},k),B(k)]);p[1]&&h({count:p[1].count}),f(p[0]),u(!1)}catch(p){u(!1),console.log(p)}},V=n=>{s(t.jsxDEV(D,{detail:n,action:o.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/pages/GrantDecisionCategories.tsx",lineNumber:76,columnNumber:13},this),{width:"40vw",onModalClose(a){a!=null&&a.success?s(t.jsxDEV(D,{detail:n,action:o.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/pages/GrantDecisionCategories.tsx",lineNumber:82,columnNumber:29},this),{width:"40vw",onModalClose(){x()}}):x()}})},C=(n,a)=>{console.log(n),n===o.View&&V(a)},x=()=>{g(i.page,i.pageSize,l)};return m.useEffect(()=>{g(i.page,i.pageSize,l)},[i,l]),t.jsxDEV("div",{className:"w-[900px]",children:t.jsxDEV(P,{className:"mt-5",isReloadButton:!0,setFilter:b,setPagination:c,dataSource:[...d],columns:e,paginationCustom:{current:i.page,pageSize:i.pageSize,total:r==null?void 0:r.count},onChange:({current:n,pageSize:a})=>{c({page:n,pageSize:a}),g(n,a,l)},actionList:Q,actionClick:C,isAction:!1,loading:N,rowKey:"id",filterColumns:[S.Name],btnCreate:!0,handleCreate:()=>{s(t.jsxDEV(D,{action:o.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/pages/GrantDecisionCategories.tsx",lineNumber:139,columnNumber:25},this),{width:"40vw",onModalClose(n){n!=null&&n.success&&x()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/pages/GrantDecisionCategories.tsx",lineNumber:112,columnNumber:13},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/logistics-categories/pages/GrantDecisionCategories.tsx",lineNumber:111,columnNumber:9},this)}export{ee as default};
