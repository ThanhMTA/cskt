import{e as V,J as _,K as I,O as K,Q as j,R as A,t as D,v as F,w as E,x as M,r as o,y as a,j as i,k as L,q,F as P,S as z,z as U,B as k,E as R,G as B}from"./index-DXrCg2vr.js";import{M as O}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{I as T}from"./ItemsComponent-Ct2UsBCT.js";import"./index-B0_H1u92.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";const G=(n,s)=>V("security_categories",{...n,fields:["*"],filter:s}),H=async n=>{var c;return{count:(c=(await _("security_categories",{aggregate:{countDistinct:"id"},query:{filter:n}}))[0].countDistinct)==null?void 0:c.id}},J=(n,s)=>I("security_categories",n,{fields:["*"],filter:s}),Q=n=>K("security_categories",{...n}),X=(n,s)=>j("security_categories",n,{...s}),Z=n=>A("security_categories",n);function w({id:n,action:s}){const[c]=D.useForm(),d=F(),b=E(),{openMessage:l}=M(),[t,x]=o.useState(),[g,u]=o.useState(!1),N=async()=>{try{d.show();const e=c.getFieldsValue();switch(s){case a.Update:await X(t==null?void 0:t.id,e),l({type:"success",content:"Cập nhật thành công"});break;case a.Create:await Q(e),l({type:"success",content:"Thêm mới thành công"}),c.resetFields();break;case a.View:break}h()}catch(e){console.log(e),l({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"}),d.hide()}},S=async()=>{try{await Z(t==null?void 0:t.id),l({type:"success",content:"Xóa thành công"}),d.hide(),b.closeModal({})}catch(e){console.log(e),l({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"})}},p=()=>{if(s===a.View){h();return}else c.submit()},h=()=>{d.hide(),b.closeModal({success:!0})};o.useMemo(()=>s===a.View?"borderless":"outlined",[s]);const y=async()=>{try{u(!0);const e=await J(n,{});console.log(e),x(e),u(!1)}catch(e){console.log(e),u(!1)}},m=o.useMemo(()=>[{title:"Tên độ mật",content:(t==null?void 0:t.name)||null,require:!0,dataIndex:"name",rules:[{required:!0,message:"Thông tin không được để trống"}]},{title:"Ký hiệu độ mật",content:(t==null?void 0:t.short_name)||null,dataIndex:"short_name"},{title:"Mã mở rộng",content:(t==null?void 0:t.code_ex)||null,dataIndex:"code_ex"},{title:"Mã định danh mở rộng",content:(t==null?void 0:t.id_ex)||null,dataIndex:"id_ex"},{title:"Số thứ tự",content:(t==null?void 0:t.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(t==null?void 0:t.is_enable)===void 0?!0:t==null?void 0:t.is_enable,dataIndex:"is_enable"}],[t]);return o.useEffect(()=>{n&&y()},[n]),i.jsxDEV(L,{...q,className:"flex",size:20,children:[i.jsxDEV(P,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:i.jsxDEV(O,{name:"độ mật",action:s,hanldeFinish:p,handleDelete:S},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:166,columnNumber:17},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:161,columnNumber:13},this),g?i.jsxDEV(i.Fragment,{children:i.jsxDEV(z,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:168,columnNumber:28},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:168,columnNumber:26},this):i.jsxDEV(D,{form:c,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",initialValues:t,disabled:s===a.View,onFinish:N,children:s===a.Update||s===a.Create?i.jsxDEV(i.Fragment,{children:m.map((e,r)=>i.jsxDEV(T,{title:e==null?void 0:e.title,rules:e==null?void 0:e.rules,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!0,isNumberField:(e==null?void 0:e.dataIndex)==="order_number",isRadioField:(e==null?void 0:e.dataIndex)==="is_enable",dataIndex:e.dataIndex},r,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:179,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:176,columnNumber:21},this):i.jsxDEV(i.Fragment,{children:m.map((e,r)=>i.jsxDEV("div",{className:"flex flex-col pb-4",children:i.jsxDEV(T,{title:e==null?void 0:e.title,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!1,dataIndex:e.dataIndex,isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},r,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:198,columnNumber:37},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:197,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:194,columnNumber:21},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:168,columnNumber:46},this)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/SecurityAction.tsx",lineNumber:156,columnNumber:9},this)}const W=[{key:a.View,icon:i.jsxDEV(B,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/SecurityCategories.tsx",lineNumber:18,columnNumber:15},void 0),tooltip:"Chi tiết"}];function ie(){const{openModal:n}=E(),[s,c]=o.useState({page:1,pageSize:U}),[d,b]=o.useState([]),[l,t]=o.useState({count:0}),[x,g]=o.useState(!1),[u,N]=o.useState({}),S=[{title:"Tên",dataIndex:"name",key:k.Name,render:(e,r)=>i.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>y(a.View,r),children:e??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/SecurityCategories.tsx",lineNumber:38,columnNumber:21},this)},{title:"Tên rút gọn",dataIndex:"short_name",key:k.ShortName},{title:"Mã mở rộng",dataIndex:"code_ex",key:"code_ex"},{title:"Trạng thái",dataIndex:"is_enable",key:"is_enable",render:e=>e?i.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/SecurityCategories.tsx",lineNumber:61,columnNumber:47},this):i.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/SecurityCategories.tsx",lineNumber:61,columnNumber:99},this)}],p=async(e,r,C)=>{try{g(!0);const f=await Promise.all([G({limit:r,page:e},C),H(C)]);f[1]&&t({count:f[1].count}),b(f[0]),g(!1)}catch(f){g(!1),console.log(f)}},h=e=>{n(i.jsxDEV(w,{id:e==null?void 0:e.id,action:a.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/SecurityCategories.tsx",lineNumber:82,columnNumber:13},this),{width:"40vw",onModalClose(r){r!=null&&r.success?n(i.jsxDEV(w,{id:e==null?void 0:e.id,action:a.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/SecurityCategories.tsx",lineNumber:88,columnNumber:29},this),{width:"40vw",onModalClose(){m()}}):m()}})},y=(e,r)=>{console.log(e),e===a.View&&h(r)},m=()=>{p(s.page,s.pageSize,u)};return o.useEffect(()=>{p(s.page,s.pageSize,u)},[s,u]),i.jsxDEV("div",{className:"w-[900px]",children:i.jsxDEV(R,{className:"mt-5",setFilter:N,setPagination:c,isReloadButton:!0,dataSource:[...d],columns:S,paginationCustom:{current:s.page,pageSize:s.pageSize,total:l==null?void 0:l.count},onChange:({current:e,pageSize:r})=>{c({page:e,pageSize:r}),p(e,r,u)},actionList:W,actionClick:y,isAction:!1,loading:x,rowKey:"id",filterColumns:[k.Name],btnCreate:!0,handleCreate:()=>{n(i.jsxDEV(w,{action:a.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/SecurityCategories.tsx",lineNumber:144,columnNumber:21},this),{width:"40vw",onModalClose(e){e!=null&&e.success&&m()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/SecurityCategories.tsx",lineNumber:117,columnNumber:9},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/SecurityCategories.tsx",lineNumber:116,columnNumber:12},this)}export{ie as default};
