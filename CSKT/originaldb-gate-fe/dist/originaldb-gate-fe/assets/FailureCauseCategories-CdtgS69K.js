import{e as V,J as _,O as I,Q as M,R as j,t as D,v as K,w as A,x as L,r as g,j as a,k as O,q as R,F as U,y as i,z as q,B as w,W as P,E as z,G as B}from"./index-DXrCg2vr.js";import{I as T}from"./ItemsComponent-Ct2UsBCT.js";import{M as H}from"./ModalCategoryActionHeader-CMTsFAdF.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";import"./index-B0_H1u92.js";const p="failure_cause_categories",G=(s,n)=>V(p,{...s,fields:["*"],filter:n}),J=async s=>{var c;return{count:(c=(await _(p,{aggregate:{countDistinct:"id"},query:{filter:s}}))[0].countDistinct)==null?void 0:c.id}},Q=s=>I(p,{...s}),W=(s,n)=>M(p,s,{...n}),X=s=>j(p,s),h={NAME:"Nội dung nguyên nhân hỏng hóc",CODE:"Mã nguyên nhân hỏng hóc",SHORT_NAME:"Tên viết tắt",IS_ENABLE:"Trạng thái"},Z=({detail:s,action:n})=>{const[c]=D.useForm(),r=K(),C=A(),{openMessage:u}=L(),f=async()=>{try{r.show();const e=c.getFieldsValue();switch(n){case i.Update:await W(s==null?void 0:s.id,e),u({type:"success",content:"Cập nhật thành công"});break;case i.Create:await Q(e),u({type:"success",content:"Thêm mới thành công"}),c.resetFields();break;case i.View:break}m()}catch(e){console.log(e),u({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"}),r.hide()}},l=async()=>{try{await X(s==null?void 0:s.id),u({type:"success",content:"Xóa thành công"}),r.hide(),C.closeModal({})}catch(e){console.log(e),u({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"})}},N=()=>{if(n===i.View){m();return}else c.submit()},m=()=>{r.hide(),C.closeModal({success:!0})},b=g.useMemo(()=>[{title:h.NAME,content:(s==null?void 0:s.name)||null,require:!0,dataIndex:"name",rules:[{required:!0,message:"Thông tin không được để trống."}]},{title:h.SHORT_NAME,content:(s==null?void 0:s.short_name)||null,dataIndex:"short_name"},{title:"Số thứ tự",content:(s==null?void 0:s.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(s==null?void 0:s.is_enable)===void 0?!0:s==null?void 0:s.is_enable,dataIndex:"is_enable"}],[s]);return a.jsxDEV(O,{...R,className:"flex",size:20,children:[a.jsxDEV(U,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:a.jsxDEV(H,{name:"nguyên nhân hỏng hóc",action:n,hanldeFinish:N,handleDelete:l},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/FailureCauseCategoriesAction.tsx",lineNumber:136,columnNumber:9},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/FailureCauseCategoriesAction.tsx",lineNumber:131,columnNumber:7},void 0),a.jsxDEV(D,{form:c,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",disabled:n===i.View,onFinish:f,children:n===i.Update||n===i.Create?a.jsxDEV(a.Fragment,{children:b.map((e,d)=>a.jsxDEV(T,{title:e==null?void 0:e.title,rules:e==null?void 0:e.rules,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!0,isNumberField:(e==null?void 0:e.dataIndex)==="order_number",isRadioField:(e==null?void 0:e.dataIndex)==="is_enable",dataIndex:e.dataIndex},d,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/FailureCauseCategoriesAction.tsx",lineNumber:148,columnNumber:17},void 0))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/FailureCauseCategoriesAction.tsx",lineNumber:145,columnNumber:11},void 0):a.jsxDEV(a.Fragment,{children:b.map((e,d)=>a.jsxDEV("div",{className:"flex flex-col pb-4",children:a.jsxDEV(T,{title:e==null?void 0:e.title,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!1,dataIndex:e.dataIndex,isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},d,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/FailureCauseCategoriesAction.tsx",lineNumber:167,columnNumber:19},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/FailureCauseCategoriesAction.tsx",lineNumber:166,columnNumber:17},void 0))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/FailureCauseCategoriesAction.tsx",lineNumber:163,columnNumber:11},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/FailureCauseCategoriesAction.tsx",lineNumber:138,columnNumber:7},void 0)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/FailureCauseCategoriesAction.tsx",lineNumber:126,columnNumber:5},void 0)},E=Z,$=[{key:i.View,icon:a.jsxDEV(B,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/FailureCauseCategories.tsx",lineNumber:20,columnNumber:11},void 0),tooltip:"Chi tiết"}];function ne(){const{openModal:s}=A(),[n,c]=g.useState([]),[r,C]=g.useState({count:0}),[u,f]=g.useState(!1),[l,N]=g.useState({page:1,pageSize:q}),[m,b]=g.useState({}),e=[{title:h.NAME,dataIndex:"name",fixed:"left",width:300,key:w.Name,render:(t,o)=>a.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>F(i.View,o),children:t??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/FailureCauseCategories.tsx",lineNumber:44,columnNumber:11},this)},{title:h.SHORT_NAME,dataIndex:"short_name",key:w.ShortName},{title:h.IS_ENABLE,dataIndex:"is_enable",render:t=>t?a.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/FailureCauseCategories.tsx",lineNumber:61,columnNumber:41},this):a.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/FailureCauseCategories.tsx",lineNumber:61,columnNumber:93},this)}].map(t=>({...t,key:(t==null?void 0:t.key)||P()})),d=async(t,o,S)=>{try{f(!0);const k=await Promise.all([await G({limit:o,page:t},S),await J(S)]);c(k[0]),C(k[1]),f(!1)}catch{f(!1)}},F=(t,o)=>{console.log(t),t===i.View&&y(o)},y=t=>{s(a.jsxDEV(E,{detail:t,action:i.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/FailureCauseCategories.tsx",lineNumber:101,columnNumber:7},this),{width:"45vw",onModalClose(o){o!=null&&o.success?s(a.jsxDEV(E,{detail:t,action:i.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/FailureCauseCategories.tsx",lineNumber:107,columnNumber:15},this),{width:"45vw",onModalClose(){x()}}):x()}})},x=()=>{d(l.page,l.pageSize,m)};return g.useEffect(()=>{d(l.page,l.pageSize,m)},[l,m]),a.jsxDEV(a.Fragment,{children:a.jsxDEV(z,{total:(r==null?void 0:r.count)||0,className:"mt-5",setFilter:b,setPagination:N,isReloadButton:!1,dataSource:n,columns:e,actionList:$,isAction:!1,loading:u,paginationCustom:{current:l.page,pageSize:l.pageSize,total:r==null?void 0:r.count},onChange:({current:t,pageSize:o})=>{N({page:t,pageSize:o}),d(t,o,m)},actionClick:F,filterColumns:[w.Name],btnCreate:!0,handleCreate:()=>{s(a.jsxDEV(E,{action:i.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/FailureCauseCategories.tsx",lineNumber:160,columnNumber:13},this),{width:"45vw",onModalClose(t){t!=null&&t.success&&x()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/FailureCauseCategories.tsx",lineNumber:133,columnNumber:7},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/FailureCauseCategories.tsx",lineNumber:132,columnNumber:5},this)}export{$ as ACTION_TABLE,ne as default};
