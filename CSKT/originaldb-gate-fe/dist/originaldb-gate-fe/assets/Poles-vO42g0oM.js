import{e as j,J as A,O as K,Q as F,R as M,t as D,v as L,w as E,x as q,r as m,j as n,k as z,q as U,F as O,y as r,a_ as R,H as P,z as B,B as T,W as H,E as G,G as J}from"./index-DXrCg2vr.js";import{g as Q}from"./PoleType.action-pQFvgwE5.js";import{M as W}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{I as _}from"./ItemsComponent-Ct2UsBCT.js";import"./index-B0_H1u92.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";const N="poles",X=(t,a)=>j(N,{...t,fields:["*"],filter:a}),Z=async t=>{var l;return{count:(l=(await A(N,{aggregate:{countDistinct:"id"},query:{filter:t}}))[0].countDistinct)==null?void 0:l.id}},$=t=>K(N,{...t}),Y=(t,a)=>F(N,t,{...a}),v=t=>M(N,t),ee=({detail:t,action:a})=>{const[l]=D.useForm(),c=L(),y=E(),{openMessage:u}=q(),[d,g]=m.useState({organizations:[],poleType:[]}),b=m.useMemo(()=>[{title:"Tên cột",content:(t==null?void 0:t.name)||null,require:!0,dataIndex:"name",rules:[{required:!0,message:"Hãy nhập thông tin cho trường tên quốc gia"}]},{title:"Vị trí đặt cột",content:(t==null?void 0:t.address)||null,dataIndex:"address"},{title:"Độ cao",content:(t==null?void 0:t.height)||null,dataIndex:"height"},{title:"Đơn vị quản lý",content:(t==null?void 0:t.org_id)||null,dataIndex:"org_id"},{title:"Loại cột",content:(t==null?void 0:t.type_id)||null,dataIndex:"type_id"},{title:"Mô tả",content:(t==null?void 0:t.desc)||null,dataIndex:"desc"},{title:"Số thứ tự",content:(t==null?void 0:t.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(t==null?void 0:t.is_enable)===void 0?!0:t==null?void 0:t.is_enable,dataIndex:"is_enable"}],[t]),f=async()=>{try{const e=await Promise.all([await R({},{}),await Q({},{})]);g({organizations:e[0],poleType:e[1]})}catch{}},w=async()=>{var e,s,i,p;try{c.show();const o=l.getFieldsValue();switch(a){case r.Update:const I=(e=o==null?void 0:o.org_id)!=null&&e.value?(s=o==null?void 0:o.org_id)==null?void 0:s.value:o==null?void 0:o.org_id,V=(i=o==null?void 0:o.type_id)!=null&&i.value?(p=o==null?void 0:o.type_id)==null?void 0:p.value:o==null?void 0:o.type_id;await Y(t==null?void 0:t.id,{...o,org_id:I,type_id:V}),u({type:"success",content:"Cập nhật thành công"});break;case r.Create:await $(o),u({type:"success",content:"Thêm mới thành công"}),l.resetFields();break;case r.View:break}x()}catch(o){console.log(o),u({type:"error",content:(o==null?void 0:o.message)||"Lỗi hệ thống"}),c.hide()}},C=async()=>{try{await v(t==null?void 0:t.id),u({type:"success",content:"Xóa thành công"}),x()}catch(e){console.log(e),u({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"})}},h=()=>{if(a===r.View){x();return}else{w();return}},x=()=>{c.hide(),y.closeModal({success:!0})},k=e=>{if(["org_id"].includes(e))return P(d==null?void 0:d.organizations,"name","id");if(["type_id"].includes(e))return P(d==null?void 0:d.poleType,"name","id")};return m.useEffect(()=>{f()},[]),n.jsxDEV(z,{...U,className:"flex",size:20,children:[n.jsxDEV(O,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:n.jsxDEV(W,{name:"cột",action:a,hanldeFinish:h,handleDelete:C},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/PolesAction.tsx",lineNumber:201,columnNumber:9},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/PolesAction.tsx",lineNumber:196,columnNumber:7},void 0),n.jsxDEV(D,{form:l,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",onFinish:w,requiredMark:!1,children:a===r.Update||a===r.Create?n.jsxDEV(n.Fragment,{children:b.map((e,s)=>n.jsxDEV(_,{title:e==null?void 0:e.title,rules:e==null?void 0:e.rules,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!0,addressField:(e==null?void 0:e.dataIndex)==="ward_id",selectField:{isSelect:(e==null?void 0:e.dataIndex)==="org_id"||(e==null?void 0:e.dataIndex)==="type_id",dataSelect:k(e==null?void 0:e.dataIndex)},isRadioField:(e==null?void 0:e.dataIndex)==="is_enable",isNumberField:(e==null?void 0:e.dataIndex)==="order_number",dataIndex:e.dataIndex},s,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/PolesAction.tsx",lineNumber:305,columnNumber:17},void 0))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/PolesAction.tsx",lineNumber:302,columnNumber:11},void 0):n.jsxDEV(n.Fragment,{children:b.map((e,s)=>n.jsxDEV("div",{className:"flex flex-col pb-4",children:n.jsxDEV(_,{title:e==null?void 0:e.title,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!1,dataIndex:e.dataIndex},s,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/PolesAction.tsx",lineNumber:331,columnNumber:19},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/PolesAction.tsx",lineNumber:330,columnNumber:17},void 0))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/PolesAction.tsx",lineNumber:327,columnNumber:11},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/PolesAction.tsx",lineNumber:203,columnNumber:7},void 0)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/PolesAction.tsx",lineNumber:191,columnNumber:5},void 0)},S=ee,te=[{key:r.View,icon:n.jsxDEV(J,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/Poles.tsx",lineNumber:23,columnNumber:11},void 0),tooltip:"Chi tiết"}];function de(){const{openModal:t}=E(),[a,l]=m.useState([]),[c,y]=m.useState({count:0}),[u,d]=m.useState(!1),[g,b]=m.useState({page:1,pageSize:B}),[f,w]=m.useState({}),C=[{title:"Tên cột",dataIndex:"name",fixed:"left",width:200,key:T.Name,render:(s,i)=>n.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>k(r.View,i),children:s??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/Poles.tsx",lineNumber:49,columnNumber:11},this)},{title:"Vị trí đặt cột",dataIndex:"address",width:300},{title:"Đơn vị quản lý",dataIndex:"org_id",width:330},{title:"Loại cột",dataIndex:"type_id",width:330},{title:"Độ cao",dataIndex:"height",width:200},{title:"Trạng thái",dataIndex:"is_enable",width:150,render:s=>s?n.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/Poles.tsx",lineNumber:84,columnNumber:11},this):n.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/Poles.tsx",lineNumber:86,columnNumber:11},this)}].map(s=>({...s,key:(s==null?void 0:s.key)||H()})),h=async(s,i,p)=>{try{d(!0);const o=await Promise.all([await X({limit:i,page:s},p),await Z({})]);l(o[0]),y(o[1]),d(!1)}catch{d(!1)}},x=s=>{t(n.jsxDEV(S,{detail:s,action:r.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/Poles.tsx",lineNumber:111,columnNumber:15},this),{width:"40vw",onModalClose(i){i!=null&&i.success&&t(n.jsxDEV(S,{detail:s,action:r.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/Poles.tsx",lineNumber:115,columnNumber:21},this),{width:"40vw",onModalClose(p){p!=null&&p.success&&e()}})}})},k=(s,i)=>{console.log(s),s===r.View&&x(i)},e=()=>{h(g.page,g.pageSize,f)};return m.useEffect(()=>{h(g.page,g.pageSize,f)},[f]),n.jsxDEV("div",{className:"w-[900px]",children:n.jsxDEV(G,{total:(c==null?void 0:c.count)||0,className:"mt-5",isReloadButton:!1,dataSource:a,columns:C,actionList:te,isAction:!1,loading:u,setPagination:b,setFilter:w,paginationCustom:{current:g.page,pageSize:g.pageSize,total:c==null?void 0:c.count},onChange:({current:s,pageSize:i})=>{b({page:s,pageSize:i}),h(s,i,f)},actionClick:k,filterColumns:[T.Name],btnCreate:!0,handleCreate:()=>{t(n.jsxDEV(S,{action:r.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/Poles.tsx",lineNumber:170,columnNumber:21},this),{width:"40vw",onModalClose(s){s!=null&&s.success&&e()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/Poles.tsx",lineNumber:144,columnNumber:7},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/Poles.tsx",lineNumber:143,columnNumber:5},this)}export{te as ACTION_TABLE,de as default};
