import{e as T,J as _,K as V,O as I,Q as K,R as j,t as D,v as A,w as E,x as F,r as c,j as t,k as M,q as L,F as q,S as P,y as o,z,B as C,E as R,G as B}from"./index-DXrCg2vr.js";import{M as O}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{I as U}from"./ItemsComponent-Ct2UsBCT.js";import"./index-B0_H1u92.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";const G=(a,n)=>T("urgency_categories",{...a,fields:["*"],filter:n}),H=async a=>{var i;return{count:(i=(await _("urgency_categories",{aggregate:{countDistinct:"id"},query:{filter:a}}))[0].countDistinct)==null?void 0:i.id}},J=(a,n)=>V("urgency_categories",a,{fields:["*"],filter:n}),Q=a=>I("urgency_categories",{...a}),X=(a,n)=>K("urgency_categories",a,{...n}),Z=a=>j("urgency_categories",a);function w({id:a,action:n}){const[i]=D.useForm(),g=A(),h=E(),{openMessage:l}=F(),[s,y]=c.useState(),[u,d]=c.useState(!1),N=async()=>{try{g.show();const e=i.getFieldsValue();switch(n){case o.Update:await X(s==null?void 0:s.id,e),l({type:"success",content:"Cập nhật thành công"});break;case o.Create:await Q(e),l({type:"success",content:"Thêm mới thành công"}),i.resetFields();break;case o.View:break}b()}catch(e){console.log(e),l({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"}),g.hide()}},k=async()=>{try{await Z(s==null?void 0:s.id),l({type:"success",content:"Xóa thành công"}),g.hide(),h.closeModal({})}catch(e){console.log(e),l({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"})}},p=()=>{if(n===o.View){b();return}else i.submit()},b=()=>{g.hide(),h.closeModal({success:!0})},x=async()=>{try{d(!0);const e=await J(a,{});console.log(e),y(e),d(!1)}catch(e){console.log(e),d(!1)}},m=c.useMemo(()=>[{title:"Tên độ khẩn",content:(s==null?void 0:s.name)||null,require:!0,dataIndex:"name",rules:[{required:!0,message:"Thông tin không được để trống"}]},{title:"Ký hiệu độ khẩn",content:(s==null?void 0:s.short_name)||null,dataIndex:"short_name"},{title:"Mã mở rộng",content:(s==null?void 0:s.code_ex)||null,dataIndex:"code_ex"},{title:"Mã định danh mở rộng",content:(s==null?void 0:s.id_ex)||null,dataIndex:"id_ex"},{title:"Số thứ tự",content:(s==null?void 0:s.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(s==null?void 0:s.is_enable)===void 0?!0:s==null?void 0:s.is_enable,dataIndex:"is_enable"}],[s]);return c.useEffect(()=>{a&&x()},[a]),t.jsxDEV(M,{...L,className:"flex",size:20,children:[t.jsxDEV(q,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:t.jsxDEV(O,{name:"độ khẩn",action:n,hanldeFinish:p,handleDelete:k},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:161,columnNumber:17},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:156,columnNumber:13},this),u?t.jsxDEV(t.Fragment,{children:t.jsxDEV(P,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:163,columnNumber:28},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:163,columnNumber:26},this):t.jsxDEV(D,{form:i,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",initialValues:s,disabled:n===o.View,onFinish:N,children:n===o.Update||n===o.Create?t.jsxDEV(t.Fragment,{children:m.map((e,r)=>t.jsxDEV(U,{title:e==null?void 0:e.title,rules:e==null?void 0:e.rules,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!0,isNumberField:(e==null?void 0:e.dataIndex)==="order_number",isRadioField:(e==null?void 0:e.dataIndex)==="is_enable",dataIndex:e.dataIndex},r,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:174,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:171,columnNumber:21},this):t.jsxDEV(t.Fragment,{children:m.map((e,r)=>t.jsxDEV("div",{className:"flex flex-col pb-4",children:t.jsxDEV(U,{title:e==null?void 0:e.title,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!1,dataIndex:e.dataIndex,isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},r,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:193,columnNumber:37},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:192,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:189,columnNumber:21},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:163,columnNumber:46},this)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/UrgencyAction.tsx",lineNumber:151,columnNumber:9},this)}const W=[{key:o.View,icon:t.jsxDEV(B,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/UrgencyCategories.tsx",lineNumber:19,columnNumber:15},void 0),tooltip:"Chi tiết"}];function ne(){const{openModal:a}=E(),[n,i]=c.useState({page:1,pageSize:z}),[g,h]=c.useState([]),[l,s]=c.useState({count:0}),[y,u]=c.useState(!1),[d,N]=c.useState({}),k=[{title:"Tên độ khẩn",dataIndex:"name",key:C.Name,render:(e,r)=>t.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>x(o.View,r),children:e??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/UrgencyCategories.tsx",lineNumber:40,columnNumber:21},this)},{title:"Ký hiệu độ khẩn",dataIndex:"short_name",key:C.ShortName},{title:"Mã mở rộng",dataIndex:"code_ex",key:"code_ex"},{title:"Mã định danh mở rộng",dataIndex:"id_ex",key:"id_ex"},{title:"Trạng thái",dataIndex:"is_enable",key:"is_enable",render:e=>e?t.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/UrgencyCategories.tsx",lineNumber:68,columnNumber:47},this):t.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/UrgencyCategories.tsx",lineNumber:68,columnNumber:99},this)}],p=async(e,r,S)=>{try{u(!0);const f=await Promise.all([G({limit:r,page:e},S),H(S)]);f[1]&&s({count:f[1].count}),h(f[0]),u(!1)}catch(f){u(!1),console.log(f)}},b=e=>{a(t.jsxDEV(w,{id:e==null?void 0:e.id,action:o.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/UrgencyCategories.tsx",lineNumber:89,columnNumber:13},this),{width:"40vw",onModalClose(r){r!=null&&r.success?a(t.jsxDEV(w,{id:e==null?void 0:e.id,action:o.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/UrgencyCategories.tsx",lineNumber:95,columnNumber:29},this),{width:"40vw",onModalClose(){m()}}):m()}})},x=(e,r)=>{console.log(e),e===o.View&&b(r)},m=()=>{p(n.page,n.pageSize,d)};return c.useEffect(()=>{p(n.page,n.pageSize,d)},[n,d]),t.jsxDEV("div",{className:"w-[900px]",children:t.jsxDEV(R,{className:"mt-5",isReloadButton:!0,dataSource:[...g],columns:k,setFilter:N,setPagination:i,paginationCustom:{current:n.page,pageSize:n.pageSize,total:l==null?void 0:l.count},onChange:({current:e,pageSize:r})=>{i({page:e,pageSize:r}),p(e,r,d)},actionList:W,actionClick:x,isAction:!1,loading:y,rowKey:"id",filterColumns:[C.Name],btnCreate:!0,handleCreate:()=>{a(t.jsxDEV(w,{action:o.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/UrgencyCategories.tsx",lineNumber:152,columnNumber:21},this),{width:"40vw",onModalClose(e){e!=null&&e.success&&m()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/UrgencyCategories.tsx",lineNumber:125,columnNumber:9},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/UrgencyCategories.tsx",lineNumber:124,columnNumber:12},this)}export{ne as default};
