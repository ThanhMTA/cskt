import{e as V,J as _,O as j,Q as K,R as M,t as w,v as F,w as D,x as L,r as g,j as s,k as O,q as R,F as P,y as a,z as q,B as T,W as U,E as z,G as B}from"./index-DXrCg2vr.js";import{M as G}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{I as S}from"./ItemsComponent-Ct2UsBCT.js";import"./index-B0_H1u92.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";const p={NAME:"Tên",SHORT_NAME:"Ký hiệu",DESCRIPTION:"Ghi chú",IS_ENABLE:"Trạng thái"},N="incident_type",H=(o,t)=>V(N,{...o,fields:["*"],filter:t}),Y=async o=>{var r;return{count:(r=(await _(N,{aggregate:{countDistinct:"id"},query:{filter:o}}))[0].countDistinct)==null?void 0:r.id}},J=o=>j(N,{...o}),Q=(o,t)=>K(N,o,{...t}),W=o=>M(N,o),X=({action:o,detail:t})=>{const[r]=w.useForm(),i=F(),b=D(),{openMessage:l}=L(),u=g.useMemo(()=>[{title:p.NAME,content:(t==null?void 0:t.name)||null,require:!0,dataIndex:"name",rules:[{required:!0,message:"Tên loại sự cố không được để trống!"}]},{title:p.SHORT_NAME,content:(t==null?void 0:t.short_name)||null,dataIndex:"short_name"},{title:p.DESCRIPTION,content:(t==null?void 0:t.note)||null,dataIndex:"note"},{title:"Số thứ tự",content:(t==null?void 0:t.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(t==null?void 0:t.is_enable)===void 0?!0:t==null?void 0:t.is_enable,dataIndex:"is_enable"}],[t]),d=()=>{if(o===a.View){h();return}else r.submit()},h=()=>{i.hide(),b.closeModal({success:!0})},f=async()=>{try{i.show();const e=r.getFieldsValue();switch(o){case a.Update:await Q(t==null?void 0:t.id,e),l({type:"success",content:"Cập nhật thành công"});break;case a.Create:await J(e),l({type:"success",content:"Thêm mới thành công"}),r.resetFields();break;case a.View:break}h()}catch(e){console.log(e),l({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"}),i.hide()}},y=async()=>{try{await W(t==null?void 0:t.id),l({type:"success",content:"Xóa thành công"}),i.hide(),b.closeModal({})}catch(e){console.log(e),l({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"})}};return s.jsxDEV(O,{...R,className:"flex",size:20,children:[s.jsxDEV(P,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:s.jsxDEV(G,{name:"loại sự cố",action:o,hanldeFinish:d,handleDelete:y},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/IncidentTypeCategoryAction.tsx",lineNumber:145,columnNumber:9},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/IncidentTypeCategoryAction.tsx",lineNumber:140,columnNumber:7},void 0),s.jsxDEV(w,{form:r,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",onFinish:f,disabled:o===a.View,children:o===a.Update||o===a.Create?s.jsxDEV(s.Fragment,{children:u.map((e,m)=>s.jsxDEV(S,{title:e==null?void 0:e.title,rules:e==null?void 0:e.rules,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!0,dataIndex:e.dataIndex,isNumberField:(e==null?void 0:e.dataIndex)==="order_number",isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},m,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/IncidentTypeCategoryAction.tsx",lineNumber:157,columnNumber:17},void 0))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/IncidentTypeCategoryAction.tsx",lineNumber:154,columnNumber:11},void 0):s.jsxDEV(s.Fragment,{children:u.map((e,m)=>s.jsxDEV("div",{className:"flex flex-col pb-4",children:s.jsxDEV(S,{title:e==null?void 0:e.title,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!1,dataIndex:e.dataIndex,isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},m,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/IncidentTypeCategoryAction.tsx",lineNumber:178,columnNumber:19},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/IncidentTypeCategoryAction.tsx",lineNumber:177,columnNumber:17},void 0))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/IncidentTypeCategoryAction.tsx",lineNumber:174,columnNumber:11},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/IncidentTypeCategoryAction.tsx",lineNumber:147,columnNumber:7},void 0)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/components/IncidentTypeCategoryAction.tsx",lineNumber:135,columnNumber:5},void 0)},I=X,Z=[{key:a.View,icon:s.jsxDEV(B,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/IncidentTypeCategories.tsx",lineNumber:21,columnNumber:11},void 0),tooltip:"Chi tiết"}];function oe(){const{openModal:o}=D(),[t,r]=g.useState([]),[i,b]=g.useState({count:0}),[l,u]=g.useState(!1),[d,h]=g.useState({page:1,pageSize:q}),[f,y]=g.useState({}),e=[{title:p.NAME,dataIndex:"name",fixed:"left",key:T.Name,render:(n,c)=>s.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>k(a.View,c),children:n??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/IncidentTypeCategories.tsx",lineNumber:45,columnNumber:11},this)},{title:p.SHORT_NAME,dataIndex:"short_name",key:T.ShortName},{title:p.IS_ENABLE,dataIndex:"is_enable",render:n=>n?s.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/IncidentTypeCategories.tsx",lineNumber:62,columnNumber:41},this):s.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/IncidentTypeCategories.tsx",lineNumber:62,columnNumber:93},this)},{title:p.DESCRIPTION,dataIndex:"note"}].map(n=>({...n,key:(n==null?void 0:n.key)||U()})),m=async(n,c,E)=>{try{u(!0);const x=await Promise.all([await H({limit:c,page:n},E),await Y(E)]);r(x[0]),b(x[1]),u(!1)}catch{u(!1)}},k=(n,c)=>{n===a.View&&A(c)},A=n=>{o(s.jsxDEV(I,{detail:n,action:a.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/IncidentTypeCategories.tsx",lineNumber:105,columnNumber:7},this),{width:"40vw",onModalClose(c){c!=null&&c.success?o(s.jsxDEV(I,{detail:n,action:a.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/IncidentTypeCategories.tsx",lineNumber:111,columnNumber:15},this),{width:"40vw",onModalClose(){C()}}):C()}})},C=()=>{m(d.page,d.pageSize,f)};return g.useEffect(()=>{m(d.page,d.pageSize,f)},[d,f]),s.jsxDEV(s.Fragment,{children:s.jsxDEV(z,{total:(i==null?void 0:i.count)||0,className:"mt-5",setFilter:y,setPagination:h,isReloadButton:!1,dataSource:t,columns:e,actionList:Z,isAction:!1,loading:l,paginationCustom:{current:d.page,pageSize:d.pageSize,total:i==null?void 0:i.count},onChange:({current:n,pageSize:c})=>{h({page:n,pageSize:c}),m(n,c,f)},actionClick:k,filterColumns:[T.Name],btnCreate:!0,handleCreate:()=>{o(s.jsxDEV(I,{action:a.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/IncidentTypeCategories.tsx",lineNumber:165,columnNumber:13},this),{width:"40vw",onModalClose(n){n!=null&&n.success&&C()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/IncidentTypeCategories.tsx",lineNumber:137,columnNumber:7},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/technical-categories/pages/IncidentTypeCategories.tsx",lineNumber:136,columnNumber:5},this)}export{Z as ACTION_TABLE,oe as default};
