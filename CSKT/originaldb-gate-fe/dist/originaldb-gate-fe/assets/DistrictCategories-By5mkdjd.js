import{t as A,v as P,w as F,x as q,r as d,j as o,k as R,q as B,F as H,S as G,y as r,H as T,z as O,B as y,E as Z,G as X}from"./index-DXrCg2vr.js";import{M as J}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{c as Q,u as W,r as Y,g as $,a as v,m as ee}from"./District.action-DZ-61Nb8.js";import{g as te}from"./AdministrativeUnit.action-B2dXwrla.js";import{a as se}from"./Province.action-DtOd65Bp.js";import{I as K}from"./ItemsComponent-Ct2UsBCT.js";import{g as ie}from"./ZoneCategory.action-C9oUMmN9.js";import"./index-B0_H1u92.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";function E({id:p,action:a}){const[u]=A.useForm(),h=P(),D=F(),{openMessage:l}=q(),[t,C]=d.useState(),[_,g]=d.useState(!1),[m,w]=d.useState({adminUnits:[],provinces:[],zones:[]}),b=d.useMemo(()=>[{title:"Tên",content:(t==null?void 0:t.name)||null,require:!0,dataIndex:"name",rules:[{required:!0,message:"Hãy nhập thông tin cho trường tên huyện"}]},{title:"Tên rút gọn",content:(t==null?void 0:t.short_name)||null,dataIndex:"short_name"},{title:"Mã mở rộng",content:(t==null?void 0:t.code_ex)||null,dataIndex:"code_ex"},{title:"Đơn vị hành chính",content:(t==null?void 0:t.admin_unit_id)||null,dataIndex:"admin_unit_id"},{title:"Tỉnh",content:(t==null?void 0:t.province_id)||null,dataIndex:"province_id"},{title:"Thuộc khu vực",content:(t==null?void 0:t.zone_id)||null,dataIndex:"zone_id"},{title:"Số thứ tự",content:(t==null?void 0:t.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(t==null?void 0:t.is_enable)===void 0?!0:t==null?void 0:t.is_enable,dataIndex:"is_enable"}],[t]),S=async()=>{var e,N,I,V,j,z;try{h.show();const s=u.getFieldsValue(),M=(e=s==null?void 0:s.province_id)!=null&&e.value?(N=s==null?void 0:s.province_id)==null?void 0:N.value:s==null?void 0:s.province_id,L=(I=s==null?void 0:s.admin_unit_id)!=null&&I.value?(V=s==null?void 0:s.admin_unit_id)==null?void 0:V.value:s==null?void 0:s.admin_unit_id,U=(j=s==null?void 0:s.zone_id)!=null&&j.value?(z=s==null?void 0:s.zone_id)==null?void 0:z.value:s==null?void 0:s.zone_id;switch(a){case r.Update:await W(t==null?void 0:t.id,{...s,province_id:M,admin_unit_id:L,zone_id:U}),l({type:"success",content:"Cập nhật thành công"});break;case r.Create:await Q(s),l({type:"success",content:"Thêm mới thành công"}),u.resetFields();break;case r.View:break}i()}catch(s){console.log(s),l({type:"error",content:(s==null?void 0:s.message)||"Lỗi hệ thống"}),h.hide()}},k=async()=>{try{await Y(t==null?void 0:t.id),l({type:"success",content:"Xóa thành công"}),h.hide(),D.closeModal({})}catch(e){console.log(e),l({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"})}},x=()=>{if(a===r.View){i();return}else u.submit()},i=()=>{h.hide(),D.closeModal({success:!0})},n=async()=>{try{g(!0);const e=await $(p,{});C(e),g(!1)}catch(e){console.log(e),g(!1)}},c=async()=>{try{const e=await Promise.all([te({limit:-1},{}),se({limit:-1},{}),ie({limit:-1},{})]);w({adminUnits:e[0],provinces:e[1],zones:e[2]})}catch(e){console.log(e)}},f=e=>{if(["province_id"].includes(e))return T(m==null?void 0:m.provinces,"name","id");if(["admin_unit_id"].includes(e))return T(m==null?void 0:m.adminUnits,"name","id");if(["zone_id"].includes(e))return T(m==null?void 0:m.zones,"name","id")};return d.useEffect(()=>{p&&n()},[p]),d.useEffect(()=>{c()},[]),o.jsxDEV(R,{...B,className:"flex",size:20,children:[o.jsxDEV(H,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:o.jsxDEV(J,{name:"huyện",action:a,hanldeFinish:x,handleDelete:k},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:219,columnNumber:17},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:214,columnNumber:13},this),_?o.jsxDEV(o.Fragment,{children:o.jsxDEV(G,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:221,columnNumber:28},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:221,columnNumber:26},this):o.jsxDEV(A,{form:u,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",disabled:a===r.View,onFinish:S,children:a===r.Update||a===r.Create?o.jsxDEV(o.Fragment,{children:b.map((e,N)=>o.jsxDEV(K,{title:e==null?void 0:e.title,rules:e==null?void 0:e.rules,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!0,dataIndex:e.dataIndex,isNumberField:(e==null?void 0:e.dataIndex)==="order_number",selectField:{isSelect:(e==null?void 0:e.dataIndex)==="province_id"||(e==null?void 0:e.dataIndex)==="zone_id"||(e==null?void 0:e.dataIndex)==="admin_unit_id",dataSelect:f(e.dataIndex)},isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},N,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:231,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:228,columnNumber:21},this):o.jsxDEV(o.Fragment,{children:b.map((e,N)=>o.jsxDEV("div",{className:"flex flex-col pb-4",children:o.jsxDEV(K,{title:e==null?void 0:e.title,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!1,dataIndex:e.dataIndex,isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},N,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:259,columnNumber:37},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:258,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:255,columnNumber:21},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:221,columnNumber:46},this)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/DistrictAction.tsx",lineNumber:209,columnNumber:9},this)}const ne=[{key:r.View,icon:o.jsxDEV(X,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/DistrictCategories.tsx",lineNumber:19,columnNumber:15},void 0),tooltip:"Chi tiết"}];function fe(){const{openModal:p}=F(),[a,u]=d.useState({page:1,pageSize:O}),[h,D]=d.useState([]),[l,t]=d.useState({count:0}),[C,_]=d.useState(!1),[g,m]=d.useState({}),w=[{title:"Tên",dataIndex:"name",fixed:"left",key:y.Name,render:(i,n)=>o.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>k(r.View,n),children:i??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/DistrictCategories.tsx",lineNumber:38,columnNumber:21},this)},{title:"Tên rút gọn",dataIndex:"short_name",key:y.ShortName},{title:"Đơn vị hành chính",dataIndex:"admin_unit_id",key:"admin_unit_id",render:(i,n)=>{var c;return(c=n==null?void 0:n.admin_unit_id)==null?void 0:c.name}},{title:"Tỉnh",dataIndex:"province_id",key:"province_id",render:(i,n)=>{var c;return(c=n==null?void 0:n.province_id)==null?void 0:c.name}},{title:"Thuộc khu vực",dataIndex:"zone_id",key:"zone_id",render:(i,n)=>{var c;return(c=n==null?void 0:n.zone_id)==null?void 0:c.name}},{title:"Trạng thái",dataIndex:"is_enable",key:"is_enable",render:i=>i?o.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/DistrictCategories.tsx",lineNumber:74,columnNumber:47},this):o.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/DistrictCategories.tsx",lineNumber:74,columnNumber:99},this)}],b=async(i,n,c)=>{try{_(!0);const f=await Promise.all([v({limit:n,page:i},c),ee(c)]);f[1]&&t({count:f[1].count}),D(f[0]),_(!1)}catch(f){_(!1),console.log(f)}},S=i=>{p(o.jsxDEV(E,{id:i==null?void 0:i.id,action:r.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/DistrictCategories.tsx",lineNumber:94,columnNumber:13},this),{width:"40vw",onModalClose(n){n!=null&&n.success?p(o.jsxDEV(E,{id:i==null?void 0:i.id,action:r.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/DistrictCategories.tsx",lineNumber:100,columnNumber:29},this),{width:"40vw",onModalClose(c){c!=null&&c.success,x()}}):x()}})},k=(i,n)=>{console.log(i),i===r.View&&S(n)},x=()=>{b(a.page,a.pageSize,g)};return d.useEffect(()=>{b(1,a.pageSize,g)},[g]),o.jsxDEV("div",{className:"w-[900px]",children:o.jsxDEV(Z,{className:"mt-5",setPagination:u,setFilter:m,isReloadButton:!0,dataSource:[...h],columns:w,paginationCustom:{current:a.page,pageSize:a.pageSize,total:l==null?void 0:l.count},onChange:({current:i,pageSize:n})=>{u({page:i,pageSize:n}),b(a.page,a.pageSize,g)},actionList:ne,actionClick:k,isAction:!1,loading:C,rowKey:"id",filterColumns:[y.Name],btnCreate:!0,handleCreate:()=>{p(o.jsxDEV(E,{action:r.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/DistrictCategories.tsx",lineNumber:160,columnNumber:21},this),{width:"40vw",onModalClose(i){i!=null&&i.success&&x()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/DistrictCategories.tsx",lineNumber:133,columnNumber:9},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/DistrictCategories.tsx",lineNumber:132,columnNumber:12},this)}export{fe as default};
