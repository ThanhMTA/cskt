import{t as A,v as q,w as F,x as z,r as m,j as o,k as R,q as B,F as H,S as G,y as c,H as D,z as O,B as P,E as Q,G as X}from"./index-DXrCg2vr.js";import{M as Z}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{c as J,u as W,r as Y,g as $,a as v,m as ee}from"./Province.action-DtOd65Bp.js";import{g as te}from"./Region.action-DLCgoOK4.js";import{g as ie}from"./MilitaryDistrict.action-DAlwc088.js";import{g as se}from"./AdministrativeUnit.action-B2dXwrla.js";import{I as K}from"./ItemsComponent-Ct2UsBCT.js";import"./index-B0_H1u92.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";function E({id:g,action:d}){const[u]=A.useForm(),p=q(),k=F(),{openMessage:l}=z(),[t,w]=m.useState(),[a,h]=m.useState({adminUnits:[],militaryDistricts:[],regions:[]}),[y,_]=m.useState(!1),N=async()=>{var e,x,T,I,V,j;try{p.show();const i=u.getFieldsValue(),M=(e=i==null?void 0:i.region_id)!=null&&e.value?(x=i==null?void 0:i.region_id)==null?void 0:x.value:i==null?void 0:i.region_id,U=(T=i==null?void 0:i.admin_unit_id)!=null&&T.value?(I=i==null?void 0:i.admin_unit_id)==null?void 0:I.value:i==null?void 0:i.admin_unit_id,L=(V=i==null?void 0:i.military_distric_id)!=null&&V.value?(j=i==null?void 0:i.military_distric_id)==null?void 0:j.value:i==null?void 0:i.military_distric_id;switch(d){case c.Update:await W(t==null?void 0:t.id,{...i,region_id:M,admin_unit_id:U,military_distric_id:L}),l({type:"success",content:"Cập nhật thành công"});break;case c.Create:await J(i),l({type:"success",content:"Thêm mới thành công"}),u.resetFields();break;case c.View:break}b()}catch(i){console.log(i),l({type:"error",content:(i==null?void 0:i.message)||"Lỗi hệ thống"}),p.hide()}},S=async()=>{try{await Y(t==null?void 0:t.id),l({type:"success",content:"Xóa thành công"}),p.hide(),k.closeModal({})}catch(e){console.log(e),l({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"})}},C=()=>{if(d===c.View){b();return}else u.submit()},b=()=>{p.hide(),k.closeModal({success:!0})},s=async()=>{try{_(!0);const e=await $(g,{});w(e),_(!1)}catch(e){console.log(e),_(!1)}},n=async()=>{try{const e=await Promise.all([te({limit:-1},{}),se({limit:-1},{}),ie({limit:-1},{})]);h({regions:e[0],adminUnits:e[1],militaryDistricts:e[2]})}catch(e){console.log(e)}},r=m.useMemo(()=>[{title:"Tên",content:(t==null?void 0:t.name)||null,require:!0,dataIndex:"name",rules:[{required:!0,message:"Hãy nhập thông tin cho trường tên tỉnh"}]},{title:"Tên rút gọn",content:(t==null?void 0:t.short_name)||null,dataIndex:"short_name"},{title:"Mã mở rộng",content:(t==null?void 0:t.code_ex)||null,dataIndex:"code_ex"},{title:"Vùng",content:(t==null?void 0:t.region_id)||null,dataIndex:"region_id"},{title:"Đơn vị hành chính",content:(t==null?void 0:t.admin_unit_id)||null,dataIndex:"admin_unit_id"},{title:"Quân khu",content:(t==null?void 0:t.military_distric_id)||null,dataIndex:"military_distric_id"},{title:"Số thứ tự",content:(t==null?void 0:t.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(t==null?void 0:t.is_enable)===void 0?!0:t==null?void 0:t.is_enable,dataIndex:"is_enable"}],[t]),f=e=>{if(["military_distric_id"].includes(e))return D(a==null?void 0:a.militaryDistricts,"name","id");if(["admin_unit_id"].includes(e))return D(a==null?void 0:a.adminUnits,"name","id");if(["region_id"].includes(e))return D(a==null?void 0:a.regions,"name","id")};return m.useEffect(()=>{g&&s()},[g]),m.useEffect(()=>{n()},[]),o.jsxDEV(R,{...B,className:"flex",size:20,children:[o.jsxDEV(H,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:o.jsxDEV(Z,{name:"tỉnh",action:d,hanldeFinish:C,handleDelete:S},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:221,columnNumber:17},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:216,columnNumber:13},this),y?o.jsxDEV(o.Fragment,{children:o.jsxDEV(G,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:223,columnNumber:28},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:223,columnNumber:26},this):o.jsxDEV(A,{form:u,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",disabled:d===c.View,onFinish:N,children:d===c.Update||d===c.Create?o.jsxDEV(o.Fragment,{children:r.map((e,x)=>o.jsxDEV(K,{title:e==null?void 0:e.title,rules:e==null?void 0:e.rules,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!0,dataIndex:e.dataIndex,selectField:{isSelect:(e==null?void 0:e.dataIndex)==="region_id"||(e==null?void 0:e.dataIndex)==="military_distric_id"||(e==null?void 0:e.dataIndex)==="admin_unit_id",dataSelect:f(e.dataIndex)},isNumberField:(e==null?void 0:e.dataIndex)==="order_number",isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},x,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:233,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:230,columnNumber:21},this):o.jsxDEV(o.Fragment,{children:r.map((e,x)=>o.jsxDEV("div",{className:"flex flex-col pb-4",children:o.jsxDEV(K,{title:e==null?void 0:e.title,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!1,dataIndex:e.dataIndex,isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},x,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:261,columnNumber:37},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:260,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:257,columnNumber:21},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:223,columnNumber:46},this)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/ProvinceAction.tsx",lineNumber:211,columnNumber:9},this)}const ne=[{key:c.View,icon:o.jsxDEV(X,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/ProvinceCategories.tsx",lineNumber:18,columnNumber:15},void 0),tooltip:"Chi tiết"}];function pe(){const{openModal:g}=F(),[d,u]=m.useState({page:1,pageSize:O}),[p,k]=m.useState([]),[l,t]=m.useState({count:0}),[w,a]=m.useState(!1),[h,y]=m.useState({}),_=[{title:"Tên",dataIndex:"name",fixed:"left",key:P.Name,render:(s,n)=>o.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>C(c.View,n),children:s??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/ProvinceCategories.tsx",lineNumber:37,columnNumber:21},this)},{title:"Tên viết tắt",dataIndex:"short_name",key:P.ShortName},{title:"Vùng",dataIndex:"region_id",key:"region_id",render:(s,n)=>{var r;return(r=n==null?void 0:n.region_id)==null?void 0:r.name}},{title:"Đơn vị hành chính",dataIndex:"admin_unit_id",key:"admin_unit_id",render:(s,n)=>{var r;return(r=n==null?void 0:n.admin_unit_id)==null?void 0:r.name}},{title:"Quân khu",dataIndex:"military_distric_id",key:"military_distric_id",render:(s,n)=>{var r;return(r=n==null?void 0:n.military_distric_id)==null?void 0:r.name}},{title:"Mã mở rộng",dataIndex:"code_ex",key:"code_ex"},{title:"Trạng thái",dataIndex:"is_enable",key:"is_enable",render:s=>s?o.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/ProvinceCategories.tsx",lineNumber:78,columnNumber:47},this):o.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/ProvinceCategories.tsx",lineNumber:78,columnNumber:99},this)}],N=async(s,n,r)=>{try{a(!0);const f=await Promise.all([v({limit:n,page:s},r),ee(r)]);f[1]&&t({count:f[1].count}),k(f[0]),a(!1)}catch(f){a(!1),console.log(f)}},S=s=>{g(o.jsxDEV(E,{id:s==null?void 0:s.id,action:c.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/ProvinceCategories.tsx",lineNumber:99,columnNumber:13},this),{width:"40vw",onModalClose(n){n!=null&&n.success?g(o.jsxDEV(E,{id:s==null?void 0:s.id,action:c.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/ProvinceCategories.tsx",lineNumber:105,columnNumber:29},this),{width:"40vw",onModalClose(){b()}}):b()}})},C=(s,n)=>{console.log(s),s===c.View&&S(n)},b=()=>{N(d.page,d.pageSize,h)};return m.useEffect(()=>{N(1,d.pageSize,h)},[h]),o.jsxDEV("div",{className:"w-[900px]",children:o.jsxDEV(Q,{className:"mt-5",isReloadButton:!0,dataSource:[...p],columns:_,setFilter:y,setPagination:u,paginationCustom:{current:d.page,pageSize:d.pageSize,total:l==null?void 0:l.count},onChange:({current:s,pageSize:n})=>{u({page:s,pageSize:n}),N(s,n,h)},actionList:ne,actionClick:C,isAction:!1,loading:w,rowKey:"id",filterColumns:[P.Name],btnCreate:!0,handleCreate:()=>{g(o.jsxDEV(E,{action:c.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/ProvinceCategories.tsx",lineNumber:161,columnNumber:21},this),{width:"40vw",onModalClose(s){s!=null&&s.success&&b()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/ProvinceCategories.tsx",lineNumber:134,columnNumber:9},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/pages/ProvinceCategories.tsx",lineNumber:133,columnNumber:12},this)}export{pe as default};
