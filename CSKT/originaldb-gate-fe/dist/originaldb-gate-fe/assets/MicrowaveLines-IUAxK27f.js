import{e as L,J as D,O as S,Q as V,R as E,t as I,v as A,w as T,x as K,r as u,j as s,k as j,q as F,F as z,y as r,U as q,H as P,cz as G,B as k,W as O,E as U,G as R}from"./index-DXrCg2vr.js";import{M as B}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{I as M}from"./ItemsComponent-Ct2UsBCT.js";import{a as H}from"./arrayToTree.min-Bpdh5Rxo.js";import"./index-B0_H1u92.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";const x="microwave_lines",Q=(o,e)=>L(x,{...o,fields:["*",{org_manage_id:["*"]}],filter:e}),J=async o=>{var d;return{count:(d=(await D(x,{aggregate:{countDistinct:"id"},query:{filter:o}}))[0].countDistinct)==null?void 0:d.id}},W=o=>S(x,{...o}),X=(o,e)=>V(x,o,{...e}),$=o=>E(x,o),v=({action:o,detail:e})=>{const[d]=I.useForm(),c=A(),_=T(),{openMessage:l}=K(),[m,g]=u.useState({organizations:[],type:[],modulation_type:[],polarization_type:[]}),b=u.useMemo(()=>[{title:"Tên",content:(e==null?void 0:e.name)||null,require:!0,dataIndex:"name",rules:[{required:!0,message:"Thông tin không được để trống!"}]},{title:"Ký hiệu",content:(e==null?void 0:e.symbol)||null,dataIndex:"symbol"},{title:"Đơn vị quản lý",content:(e==null?void 0:e.org_manage_id)||null,dataIndex:"org_manage_id"},{title:"Cự ly",content:(e==null?void 0:e.distance)||null,dataIndex:"distance"},{title:"Tần số thu",content:(e==null?void 0:e.receiving_frequency)||null,dataIndex:"receiving_frequency"},{title:"Độ nhạy thu",content:(e==null?void 0:e.receiving_sensitivity)||null,dataIndex:"receiving_sensitivity"},{title:"Công suất phát",content:(e==null?void 0:e.transmission_power)||null,dataIndex:"transmission_power"},{title:"Số chặng tiếp phát",content:(e==null?void 0:e.number_of_relay_stages)||null,dataIndex:"number_of_relay_stages"},{title:"Tôc độ bít (R bít)",content:(e==null?void 0:e.bit_rate)||null,dataIndex:"bit_rate"},{title:"Loại thiết bị",content:(e==null?void 0:e.type)||null,dataIndex:"type"},{title:"Dung lượng hệ thống",content:(e==null?void 0:e.capacity)||null,dataIndex:"capacity"},{title:"Loại điều chế",content:(e==null?void 0:e.modulation_type)||null,dataIndex:"modulation_type"},{title:"Độ cao anten",content:(e==null?void 0:e.antenna_height)||null,dataIndex:"antenna_height"},{title:"Phân cực",content:(e==null?void 0:e.polarization_type)||null,dataIndex:"polarization_type"},{title:"Mức suy hao",content:(e==null?void 0:e.depreciation_rate)||null,dataIndex:"depreciation_rate"},{title:"Vị trí điểm đầu",content:(e==null?void 0:e.longitude)||null,dataIndex:"longitude"},{title:"Vị trí điểm cuối",content:(e==null?void 0:e.latitude)||null,dataIndex:"latitude"},{title:"Ghi chú",content:(e==null?void 0:e.note)||null,dataIndex:"note"},{title:"Số thứ tự",content:(e==null?void 0:e.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(e==null?void 0:e.is_enable)===void 0?!0:e==null?void 0:e.is_enable,dataIndex:"is_enable"}],[e]),f=async()=>{const n=await Promise.all([await q({})]);console.log("responses: ",n),g({organizations:H.arrayToTree([...n[0]],{dataField:null}),type:[{key:"Thiết bị rắn",value:"RAN"},{key:"Thiết bị ống chân không",value:"ONG_CHAN_KHONG"}],modulation_type:[{key:"M-PSK",value:"M_PSK"},{key:"M-QAM đa mức",value:"M_QAM"}],polarization_type:[{key:"Đứng",value:"DUNG"},{key:"Ngang",value:"NGANG"}]})},N=()=>{if(o===r.View){p();return}else d.submit()},p=()=>{c.hide(),_.closeModal({success:!0})},w=async()=>{var n,h;try{c.show();const a=d.getFieldsValue();switch(o){case r.Update:const C=(n=a==null?void 0:a.org_manage_id)!=null&&n.value?(h=a==null?void 0:a.org_manage_id)==null?void 0:h.value:a==null?void 0:a.org_manage_id;await X(e==null?void 0:e.id,{...a,org_manage_id:C}),l({type:"success",content:"Cập nhật thành công"});break;case r.Create:await W({...a}),l({type:"success",content:"Thêm mới thành công"}),d.resetFields();break;case r.View:break}p()}catch(a){console.log(a),l({type:"error",content:(a==null?void 0:a.message)||"Lỗi hệ thống"}),c.hide()}},t=async()=>{try{await $(e==null?void 0:e.id),l({type:"success",content:"Xóa thành công"}),p()}catch(n){console.log(n),l({type:"error",content:(n==null?void 0:n.message)||"Lỗi hệ thống"})}},i=n=>{if(console.log("dataIndex: ",n),["type","modulation_type","polarization_type"].includes(n))return P(m==null?void 0:m.type,"name","value")};return u.useEffect(()=>{console.log("Fet tadadad"),f()},[]),s.jsxDEV(j,{...F,className:"flex",size:20,children:[s.jsxDEV(z,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:s.jsxDEV(B,{name:"danh sách tuyến cáp",action:o,hanldeFinish:N,handleDelete:t},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/MicrowaveLinesAction.tsx",lineNumber:304,columnNumber:9},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/MicrowaveLinesAction.tsx",lineNumber:299,columnNumber:7},void 0),s.jsxDEV(I,{form:d,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",onFinish:w,disabled:o===r.View,children:o===r.Update||o===r.Create?s.jsxDEV(s.Fragment,{children:b.map((n,h)=>s.jsxDEV(M,{title:n==null?void 0:n.title,rules:n==null?void 0:n.rules,content:n==null?void 0:n.content,require:n==null?void 0:n.require,statusUpdate:!0,dataIndex:n.dataIndex,isNumberField:n.dataIndex==="order_number"||n.dataIndex==="distance"||n.dataIndex==="receiving_frequency"||n.dataIndex==="receiving_sensitivity"||n.dataIndex==="transmission_power"||n.dataIndex==="number_of_relay_stages"||n.dataIndex==="bit_rate"||n.dataIndex==="capacity"||n.dataIndex==="antenna_height"||n.dataIndex==="depreciation_rate",selectField:{isSelect:n.dataIndex==="type"||n.dataIndex==="modulation_type"||n.dataIndex==="polarization_type",dataSelect:i(n.dataIndex)},treeField:{isSelect:(n==null?void 0:n.dataIndex)==="org_manage_id",dataSelect:m.organizations},isRadioField:(n==null?void 0:n.dataIndex)==="is_enable"},h,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/MicrowaveLinesAction.tsx",lineNumber:321,columnNumber:17},void 0))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/MicrowaveLinesAction.tsx",lineNumber:318,columnNumber:11},void 0):s.jsxDEV(s.Fragment,{children:b.map((n,h)=>s.jsxDEV("div",{className:"flex flex-col pb-4",children:s.jsxDEV(M,{title:n==null?void 0:n.title,content:n==null?void 0:n.content,require:n==null?void 0:n.require,statusUpdate:!1,dataIndex:n.dataIndex,isRadioField:(n==null?void 0:n.dataIndex)==="is_enable"},h,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/MicrowaveLinesAction.tsx",lineNumber:362,columnNumber:19},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/MicrowaveLinesAction.tsx",lineNumber:361,columnNumber:17},void 0))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/MicrowaveLinesAction.tsx",lineNumber:358,columnNumber:11},void 0)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/MicrowaveLinesAction.tsx",lineNumber:311,columnNumber:7},void 0)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/components/MicrowaveLinesAction.tsx",lineNumber:298,columnNumber:5},void 0)},y=v,Y=[{key:r.View,icon:s.jsxDEV(R,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/MicrowaveLines.tsx",lineNumber:27,columnNumber:11},void 0),tooltip:"Chi tiết"}];function ie(){const{openModal:o}=T(),[e,d]=u.useState([]),[c,_]=u.useState({count:0}),[l,m]=u.useState(!1),g=u.useRef({...G}),b=[{title:"Tên tuyến",dataIndex:"name",width:200,fixed:"left",key:k.Name,render:(t,i)=>s.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>p(r.View,i),children:t??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/MicrowaveLines.tsx",lineNumber:52,columnNumber:11},this)},{title:"Ký hiệu",dataIndex:"symbol",width:150,render:t=>t??""},{title:"Đơn vị quản lý",dataIndex:"org_manage_id",width:300,render:t=>(t==null?void 0:t.name)??""},{title:"Cự ly",dataIndex:"distance",width:150},{title:"Tần số thu",dataIndex:"receiving_frequency",width:150},{title:"Loại thiết bị",dataIndex:"type",width:150},{title:"Loại điều chế",dataIndex:"modulation_type",width:150},{title:"Phân cực",dataIndex:"polarization_type",width:150},{title:"Mức suy hao",dataIndex:"depreciation_rate",width:150},{title:"Dung lượng hệ thống",dataIndex:"capacity",width:150},{title:"Vị trí điểm đầu",dataIndex:"longitude",width:150},{title:"Vị trí điểm cuối",dataIndex:"latitude",width:150},{title:"Ghi chú",dataIndex:"note",width:150},{title:"Trạng thái",dataIndex:"is_enable",width:150,render:t=>t?s.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/MicrowaveLines.tsx",lineNumber:130,columnNumber:11},this):s.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/MicrowaveLines.tsx",lineNumber:132,columnNumber:11},this)}].map(t=>({...t,key:(t==null?void 0:t.key)||O()})),f=async(t,i)=>{try{m(!0);const n=await Promise.all([await Q({limit:i,page:t},{}),await J({})]);d(n[0]),_(n[1]),m(!1)}catch{m(!1)}},N=t=>{o(s.jsxDEV(y,{detail:t,action:r.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/MicrowaveLines.tsx",lineNumber:158,columnNumber:15},this),{width:"40vw",onModalClose(i){i!=null&&i.success&&o(s.jsxDEV(y,{detail:t,action:r.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/MicrowaveLines.tsx",lineNumber:163,columnNumber:13},this),{width:"40vw",onModalClose(n){n!=null&&n.success&&w()}})}})},p=(t,i)=>{console.log(t),t===r.View&&N(i)},w=()=>{f(g.current.current,g.current.pageSize)};return u.useEffect(()=>{f(g.current.current,g.current.pageSize)},[]),s.jsxDEV("div",{className:"w-[900px]",children:s.jsxDEV(U,{total:(c==null?void 0:c.count)||0,className:"mt-5",isReloadButton:!1,dataSource:e,columns:b,actionList:Y,isAction:!1,loading:l,paginationCustom:{...g.current,total:c==null?void 0:c.count},onChange:({current:t,pageSize:i})=>{g.current={current:t,pageSize:i},f(t,i)},actionClick:p,filterColumns:[k.Name],btnCreate:!0,handleCreate:()=>{o(s.jsxDEV(y,{action:r.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/MicrowaveLines.tsx",lineNumber:216,columnNumber:21},this),{width:"40vw",onModalClose(t){t!=null&&t.success&&w()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/MicrowaveLines.tsx",lineNumber:194,columnNumber:7},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/operation-categories/pages/MicrowaveLines.tsx",lineNumber:193,columnNumber:5},this)}export{Y as ACTION_TABLE,ie as default};
