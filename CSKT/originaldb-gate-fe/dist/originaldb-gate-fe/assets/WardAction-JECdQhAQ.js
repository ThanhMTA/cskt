import{t as k,v as M,w as U,x as q,r as o,j as n,k as z,q as L,F as H,S as P,y as c,H as w}from"./index-DXrCg2vr.js";import{M as R}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{c as X,u as O,r as B,a as G}from"./Ward.action-D2xWCgQ3.js";import{g as J}from"./AdministrativeUnit.action-B2dXwrla.js";import{a as Q}from"./District.action-DZ-61Nb8.js";import{I}from"./ItemsComponent-Ct2UsBCT.js";function st({id:l,action:a}){const[m]=k.useForm(),g=M(),h=U(),{openMessage:d}=q(),[s,S]=o.useState(),[i,D]=o.useState({adminUnits:[],districts:[]}),[y,f]=o.useState(!1),A=async()=>{var t,r,b,_,u,N;try{g.show();const e=m.getFieldsValue(),j=(t=e==null?void 0:e.district_id)!=null&&t.value?(r=e==null?void 0:e.district_id)==null?void 0:r.value:e==null?void 0:e.district_id,V=(b=e==null?void 0:e.admin_unit_id)!=null&&b.value?(_=e==null?void 0:e.admin_unit_id)==null?void 0:_.value:e==null?void 0:e.admin_unit_id,K=(u=e==null?void 0:e.zone_id)!=null&&u.value?(N=e==null?void 0:e.zone_id)==null?void 0:N.value:e==null?void 0:e.zone_id;switch(a){case c.Update:await O(s==null?void 0:s.id,{...e,district_id:j,admin_unit_id:V,zone_id:K}),d({type:"success",content:"Cập nhật thành công"});break;case c.Create:await X(e),d({type:"success",content:"Thêm mới thành công"}),m.resetFields();break;case c.View:break}p()}catch(e){console.log(e),d({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"}),g.hide()}},C=async()=>{try{await B(s==null?void 0:s.id),d({type:"success",content:"Xóa thành công"}),g.hide(),h.closeModal({})}catch(t){console.log(t),d({type:"error",content:(t==null?void 0:t.message)||"Lỗi hệ thống"})}},E=()=>{if(a===c.View){p();return}else m.submit()},p=()=>{g.hide(),h.closeModal({success:!0})},x=o.useMemo(()=>[{title:"Xã/phường/thị trấn",content:(s==null?void 0:s.name)||null,require:!0,dataIndex:"name",rules:[{required:!0,message:"Hãy nhập thông tin cho trường tên xã"}]},{title:"Tên rút gọn",content:(s==null?void 0:s.short_name)||null,dataIndex:"short_name"},{title:"Mã mở rộng",content:(s==null?void 0:s.code_ex)||null,dataIndex:"code_ex"},{title:"Đơn vị hành chính",content:(s==null?void 0:s.admin_unit_id)||null,dataIndex:"admin_unit_id"},{title:"Huyện",content:(s==null?void 0:s.district_id)||null,dataIndex:"district_id"},{title:"Số thứ tự",content:(s==null?void 0:s.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(s==null?void 0:s.is_enable)===void 0?!0:s==null?void 0:s.is_enable,dataIndex:"is_enable"}],[s]),W=async()=>{try{f(!0);const t=await G(l,{});S(t),f(!1)}catch(t){console.log(t),f(!1)}},F=async()=>{try{const t=await Promise.all([J({limit:-1},{}),Q({limit:-1},{})]);D({adminUnits:t[0],districts:t[1]})}catch(t){console.log(t)}},T=t=>{if(["district_id"].includes(t))return w(i==null?void 0:i.districts,"name","id");if(["admin_unit_id"].includes(t))return w(i==null?void 0:i.adminUnits,"name","id")};return o.useEffect(()=>{l&&W()},[l]),o.useEffect(()=>{F()},[]),n.jsxDEV(z,{...L,className:"flex",size:20,children:[n.jsxDEV(H,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:n.jsxDEV(R,{name:"xã",action:a,hanldeFinish:E,handleDelete:C},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:208,columnNumber:17},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:203,columnNumber:13},this),y?n.jsxDEV(n.Fragment,{children:n.jsxDEV(P,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:210,columnNumber:28},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:210,columnNumber:26},this):n.jsxDEV(k,{form:m,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",onFinish:A,requiredMark:!1,children:a===c.Update||a===c.Create?n.jsxDEV(n.Fragment,{children:x.map((t,r)=>n.jsxDEV(I,{title:t==null?void 0:t.title,rules:t==null?void 0:t.rules,content:t==null?void 0:t.content,require:t==null?void 0:t.require,statusUpdate:!0,dataIndex:t.dataIndex,selectField:{isSelect:(t==null?void 0:t.dataIndex)==="district_id"||(t==null?void 0:t.dataIndex)==="zone_id"||(t==null?void 0:t.dataIndex)==="admin_unit_id",dataSelect:T(t.dataIndex)},isNumberField:(t==null?void 0:t.dataIndex)==="order_number",isRadioField:(t==null?void 0:t.dataIndex)==="is_enable"},r,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:220,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:217,columnNumber:21},this):n.jsxDEV(n.Fragment,{children:x.map((t,r)=>n.jsxDEV("div",{className:"flex flex-col pb-4",children:n.jsxDEV(I,{title:t==null?void 0:t.title,content:t==null?void 0:t.content,require:t==null?void 0:t.require,statusUpdate:!1,dataIndex:t.dataIndex,isRadioField:(t==null?void 0:t.dataIndex)==="is_enable"},r,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:248,columnNumber:37},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:247,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:244,columnNumber:21},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:210,columnNumber:46},this)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/it-categories/components/WardAction.tsx",lineNumber:198,columnNumber:9},this)}export{st as W};
