import{e as E,J as V,K as I,O as K,Q as j,R as A,t as w,v as F,w as _,x as M,r,j as s,k as L,q,F as P,S as z,y as c,z as U,B as T,E as R,G as B}from"./index-DXrCg2vr.js";import{M as O}from"./ModalCategoryActionHeader-CMTsFAdF.js";import{I as S}from"./ItemsComponent-Ct2UsBCT.js";import"./index-B0_H1u92.js";import"./index-CfEarsVi.js";import"./index-Bb5KQ1O1.js";const G=(o,n)=>E("document_type_categories",{...o,fields:["*"],filter:n}),H=async o=>{var i;return{count:(i=(await V("document_type_categories",{aggregate:{countDistinct:"id"},query:{filter:o}}))[0].countDistinct)==null?void 0:i.id}},J=(o,n)=>I("document_type_categories",o,{fields:["*"],filter:n}),Q=o=>K("document_type_categories",{...o}),X=(o,n)=>j("document_type_categories",o,{...n}),Z=o=>A("document_type_categories",o);function k({id:o,action:n}){const[i]=w.useForm(),d=F(),b=_(),{openMessage:m}=M(),[t,x]=r.useState(),[p,l]=r.useState(!1),N=async()=>{try{d.show();const e=i.getFieldsValue();switch(n){case c.Update:await X(t==null?void 0:t.id,e),m({type:"success",content:"Cập nhật thành công"});break;case c.Create:await Q(e),m({type:"success",content:"Thêm mới thành công"}),i.resetFields();break;case c.View:break}h()}catch(e){console.log(e),m({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"}),d.hide()}},D=async()=>{try{await Z(t==null?void 0:t.id),m({type:"success",content:"Xóa thành công"}),d.hide(),b.closeModal({})}catch(e){console.log(e),m({type:"error",content:(e==null?void 0:e.message)||"Lỗi hệ thống"})}},g=()=>{if(n===c.View){h();return}else i.submit()},h=()=>{d.hide(),b.closeModal({success:!0})},y=async()=>{try{l(!0);const e=await J(o,{});console.log(e),x(e),l(!1)}catch(e){console.log(e),l(!1)}};r.useEffect(()=>{o&&y()},[o]);const u=r.useMemo(()=>[{title:"Tên loại văn bản",content:(t==null?void 0:t.name)||null,require:!0,dataIndex:"name",rules:[{required:!0,message:"Tên không được để trống!"}]},{title:"Ký hiệu loại văn bản",content:(t==null?void 0:t.short_name)||null,dataIndex:"short_name"},{title:"Mã mở rộng",content:(t==null?void 0:t.code_ex)||null,dataIndex:"code_ex"},{title:"Mã định danh mở rộng",content:(t==null?void 0:t.id_ex)||null,dataIndex:"id_ex"},{title:"Số thứ tự",content:(t==null?void 0:t.order_number)||null,dataIndex:"order_number"},{title:"Trạng thái",content:(t==null?void 0:t.is_enable)===void 0?!0:t==null?void 0:t.is_enable,dataIndex:"is_enable"}],[t]);return s.jsxDEV(L,{...q,className:"flex",size:20,children:[s.jsxDEV(P,{align:"center",justify:"space-between",className:"absolute bg-white left-0 right-0 px-6 pb-3 z-50",children:s.jsxDEV(O,{name:"loại văn bản",action:n,hanldeFinish:g,handleDelete:D},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:160,columnNumber:17},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:155,columnNumber:13},this),p?s.jsxDEV(s.Fragment,{children:s.jsxDEV(z,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:162,columnNumber:28},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:162,columnNumber:26},this):s.jsxDEV(w,{form:i,className:"form-container bg-secondary p-5 rounded-primary mt-10 grid grid-cols-2 gap-2",initialValues:t,disabled:n===c.View,onFinish:N,children:n===c.Update||n===c.Create?s.jsxDEV(s.Fragment,{children:u.map((e,a)=>s.jsxDEV(S,{title:e==null?void 0:e.title,rules:e==null?void 0:e.rules,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!0,isNumberField:(e==null?void 0:e.dataIndex)==="order_number",isRadioField:(e==null?void 0:e.dataIndex)==="is_enable",dataIndex:e.dataIndex},a,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:173,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:170,columnNumber:21},this):s.jsxDEV(s.Fragment,{children:u.map((e,a)=>s.jsxDEV("div",{className:"flex flex-col pb-4",children:s.jsxDEV(S,{title:e==null?void 0:e.title,content:e==null?void 0:e.content,require:e==null?void 0:e.require,statusUpdate:!1,dataIndex:e.dataIndex,isRadioField:(e==null?void 0:e.dataIndex)==="is_enable"},a,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:192,columnNumber:37},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:191,columnNumber:33},this))},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:188,columnNumber:21},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:162,columnNumber:46},this)]},void 0,!0,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/components/DocumentTypeAction.tsx",lineNumber:150,columnNumber:9},this)}const W=[{key:c.View,icon:s.jsxDEV(B,{},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/DocumentTypeCategories.tsx",lineNumber:18,columnNumber:15},void 0),tooltip:"Chi tiết"}];function ne(){const{openModal:o}=_(),[n,i]=r.useState({page:1,pageSize:U}),[d,b]=r.useState([]),[m,t]=r.useState({count:0}),[x,p]=r.useState(!1),[l,N]=r.useState({}),D=[{title:"Tên",dataIndex:"name",key:T.Name,render:(e,a)=>s.jsxDEV("span",{className:"font-semibold text-sm cursor-pointer text-[#3D73D0]",onClick:()=>y(c.View,a),children:e??""},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/DocumentTypeCategories.tsx",lineNumber:38,columnNumber:21},this)},{title:"Tên rút gọn",dataIndex:"short_name",key:T.ShortName},{title:"Mã mở rộng",dataIndex:"code_ex",key:"code_ex"},{title:"Trạng thái",dataIndex:"is_enable",key:"is_enable",render:e=>e?s.jsxDEV("span",{className:"text-green-600",children:"Hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/DocumentTypeCategories.tsx",lineNumber:61,columnNumber:47},this):s.jsxDEV("span",{className:"text-red",children:"Không hoạt động"},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/DocumentTypeCategories.tsx",lineNumber:61,columnNumber:99},this)}],g=async(e,a,C)=>{try{p(!0);const f=await Promise.all([G({limit:a,page:e},C),H(C)]);f[1]&&t({count:f[1].count}),b(f[0]),p(!1)}catch(f){p(!1),console.log(f)}},h=e=>{o(s.jsxDEV(k,{id:e==null?void 0:e.id,action:c.View},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/DocumentTypeCategories.tsx",lineNumber:82,columnNumber:13},this),{width:"40vw",onModalClose(a){a!=null&&a.success?o(s.jsxDEV(k,{id:e==null?void 0:e.id,action:c.Update},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/DocumentTypeCategories.tsx",lineNumber:88,columnNumber:29},this),{width:"40vw",onModalClose(){u()}}):u()}})},y=(e,a)=>{console.log(e),e===c.View&&h(a)},u=()=>{g(n.page,n.pageSize,l)};return r.useEffect(()=>{g(n.page,n.pageSize,l)},[n,l]),s.jsxDEV("div",{className:"w-[900px]",children:s.jsxDEV(R,{className:"mt-5",setFilter:N,setPagination:i,isReloadButton:!0,dataSource:[...d],columns:D,paginationCustom:{current:n.page,pageSize:n.pageSize,total:m==null?void 0:m.count},onChange:({current:e,pageSize:a})=>{i({page:e,pageSize:a}),g(e,a,l)},actionList:W,actionClick:y,isAction:!1,loading:x,rowKey:"id",filterColumns:[T.Name],btnCreate:!0,handleCreate:()=>{o(s.jsxDEV(k,{action:c.Create},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/DocumentTypeCategories.tsx",lineNumber:144,columnNumber:21},this),{width:"40vw",onModalClose(e){e!=null&&e.success&&u()}})}},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/DocumentTypeCategories.tsx",lineNumber:117,columnNumber:9},this)},void 0,!1,{fileName:"/workspace/cskt/CSKT/originaldb-gate-fe/src/modules/security-papers/pages/DocumentTypeCategories.tsx",lineNumber:116,columnNumber:12},this)}export{ne as default};
